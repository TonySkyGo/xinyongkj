<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>发布商品</title>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" type="text/css" href="css/jquery-ui.min.css"/>
    <link rel="stylesheet" href="css/huangwei.css">
    <link rel="stylesheet" href="css/yixin.css">
    <link rel="stylesheet" href="css/pack.css">
</head>
<body>
<div class="cs-top">
    <div class="cs-img"></div>
</div>
<div class="center-bg">
    <form id="addForm" class="container clear" action="">
        <div class="publish-top">
            <p class="publish-choose-title">您当前选择的是：</p>
            <p class="publich-choose-word">母婴&gt;食品&gt;奶粉</p>
            <a href="" class="publish-choose-modify">修改</a>
        </div>
        <div class="publish-container">
            <div class="publish-title">商品基本信息</div>
            <div class="publish-box clear">
                <div class="publish-shop">
                    <div class="publish-express-item">
                        <div class="publish-express-key">商品参数:</div>
                        <div class="publish-express-val">
                            <p class="publish-case">填错商品属性将可能导致商品下架或搜索不到，请确认填写商品属性！</p>
                        </div>
                    </div>
                    <div class="publish-express-item">
                        <div class="publish-express-key"><span class="required">*</span>品牌:</div>
                        <div class="publish-express-val">
                            <input type="text" name="brand" class="publish-base-input"/>
                        </div>
                    </div>
                    <div class="publish-express-item">
                        <div class="publish-express-key pl8">型号:</div>
                        <div class="publish-express-val">
                            <input type="text" name="version" class="publish-base-input"/>
                        </div>
                    </div>
                    <div class="publish-express-item">
                        <div class="publish-express-key pl8">上市时间:</div>
                        <div class="publish-express-val">
                            <input type="text" name="version" id="datepicker" class="publish-base-input"/>
                        </div>
                    </div>
                    <div class="publish-express-item">
                        <div class="publish-express-key pl8">产品特点:</div>
                        <div class="publish-express-val">
                            <input type="text" name="version" class="publish-base-input"/>
                        </div>
                    </div>
                    <div class="publish-express-item">
                        <div class="publish-express-key pl8">售后服务:</div>
                        <div class="publish-express-val">
                            <input type="text" name="version" class="publish-base-input"/>
                        </div>
                    </div>
                    <div class="publish-express-item">
                        <div class="publish-express-key pl8">包装清单:</div>
                        <div class="publish-express-val">
                            <input type="text" name="version" class="publish-base-input"/>
                        </div>
                    </div>

                    <div class="param-add-box"><span class="param-add">+添加自定义参数</span>（如不能满足您的需求，可添加自定义参数）</div>
                </div>
                <div class="publish-shop">
                    <div class="publish-express-item">
                        <div class="publish-express-key pl8">商品规格:</div>
                        <div class="publish-express-val">
                            <p class="publish-case">您需要选择所有的规格属性，才能组合成完整的规格信息</p>
                        </div>
                    </div>
                    <div class="publish-express-item">
                        <div class="publish-express-key pl8">选择规格:</div>
                        <div class="publish-express-val">
                            <select name="" id="sku" class="publish-select-sm">
                                <option value="1">眼镜</option>
                                <option value="2">鞋子</option>
                                <option value="3">帽子</option>
                            </select>
                        </div>
                    </div>
                    <div class="publish-express-item">
                        <div class="publish-express-key pl8">尺码:</div>
                        <div class="publish-express-val">
                            <div class="publish-sku">
                                <input type="text" class="sku-name" placeholder="填写属性名称">
                                <input type="text" class="sku-price" placeholder="填写差价">
                                <span class="sku-delete">删除</span>
                            </div>
                            <div class="sku-add">+添加属性</div>
                        </div>
                    </div>
                    <div class="publish-express-item">
                        <div class="publish-express-key pl8">尺码:</div>
                        <div class="publish-express-val">
                            <div class="publish-sku">
                                <input type="text" class="sku-name" placeholder="填写属性名称">
                                <input type="text" class="sku-price" placeholder="填写差价">
                                <span class="sku-delete">删除</span>
                            </div>
                            <div class="sku-add">+添加属性</div>
                        </div>
                    </div>
                </div>

                <div class="publish-shop">
                    <div class="publish-express-item">
                        <div class="publish-express-key"><span class="required">*</span>商品名称:</div>
                        <div class="publish-express-val">
                            <input type="text" name="name" class="publish-base-input"/>
                            <p class="publish-case">勿使用联系人、联系方式、疑问词句，特殊字符及堆砌关键词。关键包含：品牌+型号+商品关键词</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="publish-container">
            <div class="publish-title">商品交易信息</div>
            <div class="publish-box clear">
                <div class="publish-shop">
                    <div class="publish-express-item">
                        <div class="publish-express-key pl8">计量单位:</div>
                        <div class="publish-express-val">
                            <select name="" id="unit" class="publish-select-sm">
                                <option value="1">眼镜</option>
                                <option value="2">鞋子</option>
                                <option value="3">帽子</option>
                            </select>
                        </div>
                    </div>
                    <div class="publish-express-item">
                        <div class="publish-express-key pl8">出厂价:</div>
                        <div class="publish-express-val">
                            <input type="number" min="0" class="publish-trade-input">
                            <span class="publish-case">元/个</span>
                        </div>
                    </div>
                    <div class="publish-express-item">
                        <div class="publish-express-key pl8">官方价:</div>
                        <div class="publish-express-val">
                            <input type="number" min="0" class="publish-trade-input">
                            <span class="publish-case">元/个</span>
                        </div>
                    </div>
                    <div class="publish-express-item">
                        <div class="publish-express-key pl8">供应总量:</div>
                        <div class="publish-express-val">
                            <input type="number" class="publish-trade-input2">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="publish-container">
            <div class="publish-title">图片和详细说明</div>
            <div class="publish-box clear">
                <div class="publish-express-item">
                    <div class="publish-express-key"><span class="required">*</span>商品图片:</div>
                    <div class="publish-express-val">
                        <p class="publish-case">您可以上传8张图片，大小不可超过5M，第一张将为商品主图。</p>
                        <p class="publish-case">建议上传至少3张以上，不小于500*500像素的真实图片，支持jpg，jpeg，png，gif、bmp。</p>
                        <div class="publish-cover-box clear">
                            <a href="" class="publish-add-cover">
                                <input type="file" name="cover[]" class="cover-upload">
                            </a>
                        </div>
                    </div>
                </div>
                <div class="publish-express-item">
                    <div class="publish-express-key pl8">商品PDF:</div>
                    <div class="publish-express-val">
                        <input type="file" name="pdf" class="publishPdf disnone">
                        <div class="publish-addpdf">点击添加PDF</div>
                    </div>
                </div>
                <div class="publish-express-item">
                    <div class="publish-express-key"><span class="required">*</span>商品描述:</div>
                    <div class="publish-express-val">
                        <script id="editor" name="editor" type="text/plain" style="width:900px;height:320px;"></script>
                    </div>
                </div>
            </div>
        </div>
        <div class="publish-container">
            <div class="publish-title">物流运费信息</div>
            <div class="publish-box clear">
                <p class="publish-express-hint">为了提升消费者购物体验，信用空间要求全网商品设置运费模板。</p>
                <div class="publish-express-item">
                    <div class="publish-express-key"><span class="required">*</span>运费模版:</div>
                    <div class="publish-express-val">
                        <select name="" id="express" class="publish-select-sm">
                            <option value="1">111</option>
                            <option value="2">222</option>
                            <option value="3">333</option>
                        </select>
                    </div>
                </div>
                <div class="publish-express-item">
                    <div class="publish-express-key pl8">发货日期:</div>
                    <div class="publish-express-val">
                        <select name="" id="date" class="publish-select-sm">
                            <option value="1">111</option>
                            <option value="2">222</option>
                            <option value="3">333</option>
                        </select>
                        <span class="publish-case">自买家付款之日起</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="publish-container">
            <div class="publish-title">售后保障信息</div>
            <div class="publish-box clear">
                <div class="publish-key">售后服务:</div>
                <div class="publish-val">
                    <div>
                        <input type="checkbox" class="stock-num" name="servenum">
                        <span class="publish-stock">提供发票</span>
                    </div>
                    <div>
                        <input type="checkbox" class="stock-num" name="servenum">
                        <span class="publish-stock">保修服务</span>
                    </div>
                    <div>
                        <input type="checkbox" class="stock-num" name="servenum">
                        <span class="publish-stock">退换货承诺：凡通过信用空间平台发布商品，若存在质量问题或与描述不符，本店将主动提供退换货服务并承担来回邮费</span>
                    </div>
                    <div>
                        <input type="checkbox" class="stock-num" name="servenum">
                        <span class="publish-stock">服务承诺：该类商品，必须支持【七天退货】服务</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="publish-container">
            <div class="publish-title">宝贝其他信息</div>
            <div class="publish-box">
                <div class="publish-other">
                    <div class="publish-key">库存计数:</div>
                    <div class="publish-val">
                        <input type="radio" class="stock-num" name="stocknum">
                        <span class="publish-stock">买家拍下减库存</span>
                        <input type="radio" class="stock-num" name="stocknum">
                        <span class="publish-stock">买家付款减库存</span>
                    </div>
                </div>
                <div class="publish-other">
                    <div class="publish-key">上架时间:</div>
                    <div class="publish-val">
                        <input type="radio" class="stock-num" name="stocktime">
                        <span class="publish-stock">立刻上架</span>
                        <input type="radio" class="stock-num" name="stocktime">
                        <span class="publish-stock">放入仓库</span>
                    </div>
                </div>
                <div class="publish-other">
                    <div class="publish-key">橱窗推荐:</div>
                    <div class="publish-val">
                        <input type="checkbox" class="stock-num" name="stocknum">
                        <span class="publish-stock">是</span>
                        <span class="publish-case">您的橱窗使用情况：共【35个】个，已用【0】个</span>
                    </div>
                </div>
            </div>
        </div>
        <input type="submit" class="publish-submit" value="发布">
    </form>
</div>
<script src="js/jquery.min.js"></script>
<script src="js/jquery-migrate-1.2.1.min.js"></script>
<!--低版本jq兼容fancybox-->
<script src="js/jquery-ui.min.js"></script>
<script src="js/jquery.validate.min.js"></script>
<script src="js/ueditor/ueditor.config.js"></script>
<script src="js/ueditor/ueditor.all.min.js"></script>
<script src="js/script.js"></script>
<script>
    //加载编辑器
    var ue = UE.getEditor('editor');
    //表单验证
    $("#addForm").validate({
        rules: {
            brand: {required: true},
            name: {required: true}
        },
        messages: {
            brand: {required: "请填写品牌"},
            name: {required: "请填写商品名称"}
        }
    });
    //商品验证为空提示
    $("#addForm").on("submit", function () {
        if (ue.getContentTxt() == "") {
            alert("请填写商品描述");
        }
    });
    //获取选择图片路径
    function getObjectURL(file) { //获取上传图片地址
        var url = null;
        if (window.createObjectURL != undefined) { // basic
            url = window.createObjectURL(file);
        } else if (window.URL != undefined) { // mozilla(firefox)
            url = window.URL.createObjectURL(file);
        } else if (window.webkitURL != undefined) { // webkit or chrome
            url = window.webkitURL.createObjectURL(file);
        }
        return url;
    }
    //插入图片预览
    function insertPhoto(url) {
        var imgNew = '<a href="javascript:;" class="publish-preview" style="background-image: url(' + url + ');"> <div class="publish-cover-delete"></div> </a>';
        var imgFile = '<a href="" class="publish-add-cover"><input type="file" name="cover[]" class="cover-upload"></a>';
        $(".publish-cover-box").prepend(imgNew);
        $(".publish-cover-box").append(imgFile);
    }

    //新增商品参数
    function addParams(index) {
        var str = '<div class="publish-express-item"><div class="publish-express-key"><input type="text" class="param-key" name="key' + index + '">:</div><div class="publish-express-val"><input type="text" name="value' + index + '" class="publish-base-input"/><span class="param-delete">删除</span></div></div>'
        $(".param-add-box").before(str);
    }

    //新增sku
    $(".sku-add").on("click", function () {
        var str = '<div class="publish-sku"><input type="text" class="sku-name" placeholder="填写属性名称"><input type="text" class="sku-price" placeholder="填写差价"><span class="sku-delete">删除</span></div>'
        $(this).before(str);
    });
    //删除sku
    $("body").on("click", ".sku-delete", function () {
        $(this).parent().remove();
    });


    $(function () {
        var index = 0;
        //日期选择
        $("#datepicker").datepicker({
            changeYear: true,
            changeMonth: true
        });
        //点击添加pdf
        $(".publish-addpdf").on("click", function () {
            $(".publishPdf").click();
        });
        //点击添加商品自定义参数
        $(".param-add").on("click", function () {
            addParams(index);
            index++;
        });
        //删除商品参数
        $("body").on("click", ".param-delete", function () {
            $(this).parents(".publish-express-item").remove();
        });
        //选择图片
        $("body").on("change", ".cover-upload", function () {
            console.log($("#editor").val());
            if ($(".publish-preview").length > 7) {
                alert("最多上传8张图！");
                return false;
            }
            var objUrl = getObjectURL(this.files[0]);
            var filepath = $(this).val();
            var extStart = filepath.lastIndexOf(".");
            var ext = filepath.substring(extStart, filepath.length).toUpperCase();
            if (ext != ".BMP" && ext != ".PNG" && ext != ".JPEG" && ext != ".GIF" && ext != ".JPG") {
                alert("图片限于bmp,png,gif,jpg,jpeg格式");
                return false;
            }
            var file_size = 0;
            if ($.browser.msie) {
                var img = new Image();
                img.src = filepath;
                while (true) {
                    if (img.fileSize > 0) {
                        if (img.fileSize > 5 * 1024 * 1024) {
                            alert("图片不大于10MB。");
                        }
                        break;
                    }
                }
            } else {
                file_size = this.files[0].size;
                var size = file_size / 1024;
                if (size > 5120) {
                    alert("上传的图片大小不能超过5M！");
                }
            }
            if (objUrl) {
                //插入缩略图以及新增一个file input
                insertPhoto(objUrl);
                //隐藏当前添加框，并且移除class
                $(this).removeClass("cover-upload").parent().hide();
                $(this).parent().prependTo(".publish-cover-box");
            }
            return true;
        });
        //删除图片
        $("body").on("click", ".publish-cover-delete", function () {
            $(this).parent().remove();
            $(this).parent().prev().remove();
        });
    });
</script>
</body>
</html>